{% extends 'web3auth/base.html' %}
{% block content %}
  <div class="row m-t-2">
    <div class="container">
      <h4 class="col-md-12 text-center" style="margin-top: 15px" id='container-text'>Click at any menu item to interact
        with contract</h4>
    </div>
  </div>
{% endblock content %}
{% block javascript %}
  {{ block.super }}
  <script>
    var login_url = '{% url 'web3auth_login_api' %}';
    document.addEventListener('scatterLoaded', scatterExtension => {
      console.log('scatter loaded');
      if (scatter.identity) {
        console.log("Identity found");
        var account = scatter.identity.accounts.find(function (account) {
                return account.blockchain === 'eos'
            });
        loginWithAuthenticate(login_url,console.log,console.log,console.log,console.log, function (resp) {
          window.location.replace(resp.redirect_url);
        });
        document.getElementById('container-text').innerHTML = "Welcome, " + account.name + '<br>Your public key: ' + scatter.identity.publicKey
      } else {
        console.log('identity not found, have to signup')
      }
    });
  </script>
{% endblock javascript %}
